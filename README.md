# Essay-AFS (Essay Assistant Feedback System)

AI ê¸°ë°˜ ì—ì„¸ì´ í”¼ë“œë°± ì‹œìŠ¤í…œ - êµì‚¬ê°€ í•™ìƒë“¤ì˜ ì—ì„¸ì´ ê³¼ì œì™€ í‰ê°€ë¥¼ ê´€ë¦¬í•˜ê³ , AI í”¼ë“œë°±ì„ ì œê³µí•˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜

## ğŸ“‹ ëª©ì°¨

- [í”„ë¡œì íŠ¸ ì†Œê°œ](#í”„ë¡œì íŠ¸-ì†Œê°œ)
- [ì£¼ìš” ê¸°ëŠ¥](#ì£¼ìš”-ê¸°ëŠ¥)
- [ê¸°ìˆ  ìŠ¤íƒ](#ê¸°ìˆ -ìŠ¤íƒ)
- [í”„ë¡œì íŠ¸ êµ¬ì¡°](#í”„ë¡œì íŠ¸-êµ¬ì¡°)
- [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
- [ì„¤ì¹˜ ë° ì‹¤í–‰](#ì„¤ì¹˜-ë°-ì‹¤í–‰)
- [í™˜ê²½ ë³€ìˆ˜ ì„¤ì •](#í™˜ê²½-ë³€ìˆ˜-ì„¤ì •)
- [API ì—”ë“œí¬ì¸íŠ¸](#api-ì—”ë“œí¬ì¸íŠ¸)
- [ë°°í¬ ê°€ì´ë“œ](#ë°°í¬-ê°€ì´ë“œ)

## ğŸ¯ í”„ë¡œì íŠ¸ ì†Œê°œ

Essay-AFSëŠ” êµìœ¡ í˜„ì¥ì—ì„œ êµì‚¬ê°€ í•™ìƒë“¤ì˜ ì—ì„¸ì´ ì‘ì„±ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³ , AI ê¸°ìˆ ì„ í™œìš©í•˜ì—¬ ì¦‰ê°ì ì¸ í”¼ë“œë°±ì„ ì œê³µí•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### ì£¼ìš” íŠ¹ì§•

- **í•™ê¸‰ ê´€ë¦¬**: í•™ê¸‰ë³„ í•™ìƒ ê´€ë¦¬ ë° CSV ì¼ê´„ ë“±ë¡
- **ê³¼ì œ ê´€ë¦¬**: ì—ì„¸ì´ ê³¼ì œ ìƒì„±, ë°°í¬, ì œì¶œ ê´€ë¦¬
- **í‰ê°€ ê´€ë¦¬**: í‰ê°€ ê¸°ì¤€ ì„¤ì • ë° ìë™ ì±„ì 
- **AI í”¼ë“œë°±**: OpenAI/LangChain ê¸°ë°˜ ì‹¤ì‹œê°„ í”¼ë“œë°± ìƒì„±
- **í•™ìƒ ë¶„ì„**: í•™ìƒë³„ ì œì¶œ ì´ë ¥ ë° ì„±ì¥ ë¶„ì„
- **QR ì½”ë“œ**: í•™ìƒ ì œì¶œ í˜ì´ì§€ QR ì½”ë“œ ìƒì„±

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### êµì‚¬ ê¸°ëŠ¥

- í•™ê¸‰ ë° í•™ìƒ ê´€ë¦¬
- ê³¼ì œ ìƒì„± ë° ë°°í¬ (ê°€ì´ë“œë¼ì¸, ì¡°ê±´ ì„¤ì •)
- í‰ê°€ ìƒì„± ë° ë°°í¬ (í‰ê°€ ê¸°ì¤€ ì„¤ì •)
- í•™ìƒ ì œì¶œë¬¼ í™•ì¸ ë° ê´€ë¦¬
- AI í”¼ë“œë°± ìƒì„± ë° ìˆ˜ì •
- í•™ìƒë³„ ë¶„ì„ ë¦¬í¬íŠ¸ ì¡°íšŒ

### í•™ìƒ ê¸°ëŠ¥

- QR ì½”ë“œ ë˜ëŠ” ë§í¬ë¥¼ í†µí•œ ê³¼ì œ/í‰ê°€ ì ‘ê·¼
- ì—ì„¸ì´ ì‘ì„± ë° ì œì¶œ
- ì¤‘ê°„ í”¼ë“œë°± ìš”ì²­ (ì‘ì„± ì¤‘)
- ìµœì¢… í”¼ë“œë°± í™•ì¸
- ìˆ˜ì •ë³¸ ì¬ì œì¶œ

### AI ê¸°ëŠ¥

- ì¤‘ê°„ í”¼ë“œë°±: ì‘ì„± ì¤‘ì¸ ì—ì„¸ì´ì— ëŒ€í•œ ê°œì„  ì œì•ˆ
- ìµœì¢… í”¼ë“œë°±: ì œì¶œëœ ì—ì„¸ì´ì— ëŒ€í•œ ì¢…í•© í‰ê°€
- ìë™ ì±„ì : í‰ê°€ ê¸°ì¤€ì— ë”°ë¥¸ ì ìˆ˜ ì‚°ì¶œ
- ë§ì¶¤í˜• í”¼ë“œë°±: êµì‚¬ ì„¤ì • ê°€ì´ë“œë¼ì¸ ë°˜ì˜

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### í”„ë¡ íŠ¸ì—”ë“œ

| ê¸°ìˆ            | ë²„ì „   | ìš©ë„                          |
| -------------- | ------ | ----------------------------- |
| Next.js        | 15.3.5 | React í”„ë ˆì„ì›Œí¬ (App Router) |
| React          | 19.0.0 | UI ë¼ì´ë¸ŒëŸ¬ë¦¬                 |
| TypeScript     | 5.x    | íƒ€ì… ì•ˆì •ì„±                   |
| Tailwind CSS   | 4.x    | ìŠ¤íƒ€ì¼ë§                      |
| Axios          | 1.10.0 | HTTP í´ë¼ì´ì–¸íŠ¸               |
| React Markdown | 10.1.0 | ë§ˆí¬ë‹¤ìš´ ë Œë”ë§               |
| React QR Code  | 2.0.18 | QR ì½”ë“œ ìƒì„±                  |
| React Toastify | 11.0.5 | ì•Œë¦¼ ë©”ì‹œì§€                   |
| Hashids        | 2.3.0  | ID ì•”í˜¸í™”                     |

### ë°±ì—”ë“œ

| ê¸°ìˆ              | ë²„ì „     | ìš©ë„                 |
| ---------------- | -------- | -------------------- |
| FastAPI          | 0.115.14 | Python ì›¹ í”„ë ˆì„ì›Œí¬ |
| SQLAlchemy       | 2.0.41   | ORM (ë¹„ë™ê¸° ì§€ì›)    |
| Pydantic         | 2.11.7   | ë°ì´í„° ê²€ì¦          |
| Uvicorn          | 0.35.0   | ASGI ì„œë²„            |
| python-jose      | 3.5.0    | JWT í† í° ì²˜ë¦¬        |
| bcrypt           | 4.3.0    | ë¹„ë°€ë²ˆí˜¸ í•´ì‹±        |
| LangChain        | 0.3.26   | AI ì²´ì¸ êµ¬ì„±         |
| LangChain-OpenAI | 0.3.27   | OpenAI í†µí•©          |
| OpenAI           | 1.95.0   | AI API               |
| pandas           | 2.3.1    | ë°ì´í„° ë¶„ì„          |
| python-dotenv    | 1.1.1    | í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬       |

### ë°ì´í„°ë² ì´ìŠ¤

| ê¸°ìˆ       | ìš©ë„                   |
| --------- | ---------------------- |
| SQLite    | íŒŒì¼ ê¸°ë°˜ ë°ì´í„°ë² ì´ìŠ¤ |
| aiosqlite | ë¹„ë™ê¸° SQLite ë“œë¼ì´ë²„ |

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
essay-afs/
â”œâ”€â”€ app/                          # Next.js í”„ë¡ íŠ¸ì—”ë“œ (App Router)
â”‚   â”œâ”€â”€ account/                  # ê³„ì • ê´€ë ¨ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ login/               # ë¡œê·¸ì¸
â”‚   â”‚   â”œâ”€â”€ signup/              # íšŒì›ê°€ì…
â”‚   â”‚   â”œâ”€â”€ privacy-policy/      # ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨
â”‚   â”‚   â””â”€â”€ terms-of-service/    # ì´ìš©ì•½ê´€
â”‚   â”œâ”€â”€ dashboard/               # ëŒ€ì‹œë³´ë“œ
â”‚   â”œâ”€â”€ classes/                 # í•™ê¸‰ ê´€ë¦¬
â”‚   â”œâ”€â”€ students/                # í•™ìƒ ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ [token]/            # í•™ìƒ ìƒì„¸ (ë¶„ì„)
â”‚   â”œâ”€â”€ assignment/              # ê³¼ì œ ìƒì„±
â”‚   â”œâ”€â”€ assignments/             # ê³¼ì œ ëª©ë¡
â”‚   â”œâ”€â”€ evaluation/              # í‰ê°€ ìƒì„±
â”‚   â”œâ”€â”€ a_dist/                  # ê³¼ì œ ë°°í¬ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ assignment/[token]/ # í•™ìƒ ê³¼ì œ ì œì¶œ
â”‚   â”‚   â””â”€â”€ manage_submit/[token]/ # êµì‚¬ ì œì¶œ ê´€ë¦¬
â”‚   â”œâ”€â”€ e_dist/                  # í‰ê°€ ë°°í¬ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ evaluation/[token]/ # í•™ìƒ í‰ê°€ ì œì¶œ
â”‚   â”‚   â””â”€â”€ manage_submit/[token]/ # êµì‚¬ ì œì¶œ ê´€ë¦¬
â”‚   â”œâ”€â”€ components/              # ê³µí†µ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ Modal.tsx
â”‚   â”‚   â””â”€â”€ FeedbackGuideModal.tsx
â”‚   â”œâ”€â”€ hooks/                   # ì»¤ìŠ¤í…€ í›…
â”‚   â”‚   â”œâ”€â”€ auth.ts             # ì¸ì¦ í›…
â”‚   â”‚   â”œâ”€â”€ loginCheck.ts       # ë¡œê·¸ì¸ ì²´í¬
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ lib/                     # ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â”œâ”€â”€ api.ts              # API í•¨ìˆ˜
â”‚   â”‚   â”œâ”€â”€ hashids.ts          # ID ì•”í˜¸í™”
â”‚   â”‚   â””â”€â”€ utils.ts
â”‚   â”œâ”€â”€ AppLayout.tsx            # ë ˆì´ì•„ì›ƒ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ sidebar.tsx              # ì‚¬ì´ë“œë°”
â”‚   â”œâ”€â”€ layout.tsx               # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â”œâ”€â”€ page.tsx                 # í™ˆ í˜ì´ì§€
â”‚   â””â”€â”€ globals.css              # ì „ì—­ ìŠ¤íƒ€ì¼
â”‚
â”œâ”€â”€ backend/                      # FastAPI ë°±ì—”ë“œ
â”‚   â”œâ”€â”€ routers/                 # API ë¼ìš°í„°
â”‚   â”‚   â”œâ”€â”€ auth.py             # ì¸ì¦ (íšŒì›ê°€ì…, ë¡œê·¸ì¸)
â”‚   â”‚   â”œâ”€â”€ classes.py          # í•™ê¸‰ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ students.py         # í•™ìƒ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ assignments.py      # ê³¼ì œ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ evaluation.py       # í‰ê°€ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ submit.py           # ì œì¶œë¬¼ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ ai.py               # AI í”¼ë“œë°± ìƒì„±
â”‚   â”‚   â””â”€â”€ analysis.py         # í•™ìƒ ë¶„ì„
â”‚   â”œâ”€â”€ main.py                  # FastAPI ì•± ì§„ì…ì 
â”‚   â”œâ”€â”€ models.py                # SQLAlchemy ëª¨ë¸
â”‚   â”œâ”€â”€ schemas.py               # Pydantic ìŠ¤í‚¤ë§ˆ
â”‚   â”œâ”€â”€ database.py              # DB ì—°ê²° ì„¤ì •
â”‚   â”œâ”€â”€ crud.py                  # CRUD ì‘ì—…
â”‚   â”œâ”€â”€ init_db.py               # DB ì´ˆê¸°í™”
â”‚   â””â”€â”€ requirements.txt         # Python ì˜ì¡´ì„±
â”‚
â”œâ”€â”€ db/                          # ë°ì´í„°ë² ì´ìŠ¤
â”‚   â””â”€â”€ essay_afs.db            # SQLite DB íŒŒì¼
â”‚
â”œâ”€â”€ public/                      # ì •ì  íŒŒì¼
â”‚   â”œâ”€â”€ logo.png
â”‚   â””â”€â”€ favicon.ico
â”‚
â”œâ”€â”€ package.json                 # Node.js ì˜ì¡´ì„±
â”œâ”€â”€ tsconfig.json                # TypeScript ì„¤ì •
â”œâ”€â”€ next.config.ts               # Next.js ì„¤ì •
â”œâ”€â”€ tailwind.config.js           # Tailwind ì„¤ì •
â”œâ”€â”€ postcss.config.mjs           # PostCSS ì„¤ì •
â””â”€â”€ .gitignore                   # Git ì œì™¸ íŒŒì¼
```

## ğŸ—„ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### ERD ê°œìš”

```
User (êµì‚¬)
  â”œâ”€â”€ SchoolClass (í•™ê¸‰)
  â”‚     â”œâ”€â”€ Student (í•™ìƒ)
  â”‚     â”‚     â”œâ”€â”€ ASubmission (ê³¼ì œ ì œì¶œ)
  â”‚     â”‚     â”‚     â””â”€â”€ AFeedback (ê³¼ì œ í”¼ë“œë°±)
  â”‚     â”‚     â”œâ”€â”€ ESubmission (í‰ê°€ ì œì¶œ)
  â”‚     â”‚     â”‚     â””â”€â”€ EFeedback (í‰ê°€ í”¼ë“œë°±)
  â”‚     â”‚     â””â”€â”€ AnalysisResult (ë¶„ì„ ê²°ê³¼)
  â”‚     â”œâ”€â”€ Assignment (ê³¼ì œ)
  â”‚     â””â”€â”€ Evaluation (í‰ê°€)
```

### ì£¼ìš” í…Œì´ë¸”

#### users (êµì‚¬)

- `id`: ê¸°ë³¸í‚¤
- `email`: ì´ë©”ì¼ (ê³ ìœ )
- `hashed_password`: í•´ì‹œëœ ë¹„ë°€ë²ˆí˜¸
- `school_level`: í•™êµê¸‰ (ì´ˆ/ì¤‘/ê³ )
- `name`: ì´ë¦„
- `feedback_guide`: í”¼ë“œë°± ê°€ì´ë“œ (JSON)

#### classes (í•™ê¸‰)

- `id`: ê¸°ë³¸í‚¤
- `name`: í•™ê¸‰ëª…
- `grade`: í•™ë…„
- `school_level`: í•™êµê¸‰
- `user_id`: êµì‚¬ ID (ì™¸ë˜í‚¤)

#### student (í•™ìƒ)

- `id`: ê¸°ë³¸í‚¤
- `class_id`: í•™ê¸‰ ID (ì™¸ë˜í‚¤)
- `number`: ë²ˆí˜¸
- `name`: ì´ë¦„
- `email`: ì´ë©”ì¼ (ì„ íƒ)

#### assignment (ê³¼ì œ)

- `id`: ê¸°ë³¸í‚¤
- `class_id`: í•™ê¸‰ ID (ì™¸ë˜í‚¤)
- `user_id`: êµì‚¬ ID (ì™¸ë˜í‚¤)
- `name`: ê³¼ì œëª…
- `guide`: ì‘ì„± ê°€ì´ë“œ
- `condition`: ì‘ì„± ì¡°ê±´
- `status`: ìƒíƒœ (pending/in_progress/completed)
- `started_at`: ì‹œì‘ ì‹œê°„
- `completed_at`: ì™„ë£Œ ì‹œê°„

#### evaluation (í‰ê°€)

- `id`: ê¸°ë³¸í‚¤
- `class_id`: í•™ê¸‰ ID (ì™¸ë˜í‚¤)
- `user_id`: êµì‚¬ ID (ì™¸ë˜í‚¤)
- `name`: í‰ê°€ëª…
- `item`: í‰ê°€ í•­ëª©
- `criteria`: í‰ê°€ ê¸°ì¤€ (JSON)
- `status`: ìƒíƒœ
- `started_at`: ì‹œì‘ ì‹œê°„
- `completed_at`: ì™„ë£Œ ì‹œê°„

#### assign_submission (ê³¼ì œ ì œì¶œ)

- `id`: ê¸°ë³¸í‚¤
- `assignment_id`: ê³¼ì œ ID (ì™¸ë˜í‚¤)
- `student_id`: í•™ìƒ ID (ì™¸ë˜í‚¤)
- `content`: ì œì¶œ ë‚´ìš©
- `revised_content`: ìˆ˜ì • ë‚´ìš©
- `status`: ìƒíƒœ (in_progress/first_submitted/feedback_done/final_submitted)
- `submitted_at`: ì œì¶œ ì‹œê°„

#### esubmission (í‰ê°€ ì œì¶œ)

- `id`: ê¸°ë³¸í‚¤
- `evaluation_id`: í‰ê°€ ID (ì™¸ë˜í‚¤)
- `student_id`: í•™ìƒ ID (ì™¸ë˜í‚¤)
- `content`: ì œì¶œ ë‚´ìš©
- `score`: ì ìˆ˜
- `status`: ìƒíƒœ (in_progress/submitted)
- `submitted_at`: ì œì¶œ ì‹œê°„

#### assign_feedback (ê³¼ì œ í”¼ë“œë°±)

- `id`: ê¸°ë³¸í‚¤
- `assign_submission_id`: ê³¼ì œ ì œì¶œ ID (ì™¸ë˜í‚¤)
- `assignment_id`: ê³¼ì œ ID (ì™¸ë˜í‚¤)
- `student_id`: í•™ìƒ ID (ì™¸ë˜í‚¤)
- `content`: í”¼ë“œë°± ë‚´ìš©
- `created_at`: ìƒì„± ì‹œê°„

#### eval_feedback (í‰ê°€ í”¼ë“œë°±)

- `id`: ê¸°ë³¸í‚¤
- `eval_submission_id`: í‰ê°€ ì œì¶œ ID (ì™¸ë˜í‚¤)
- `evaluation_id`: í‰ê°€ ID (ì™¸ë˜í‚¤)
- `student_id`: í•™ìƒ ID (ì™¸ë˜í‚¤)
- `content`: í”¼ë“œë°± ë‚´ìš©
- `created_at`: ìƒì„± ì‹œê°„

#### analysis_results (ë¶„ì„ ê²°ê³¼)

- `id`: ê¸°ë³¸í‚¤
- `student_id`: í•™ìƒ ID (ì™¸ë˜í‚¤)
- `analysis_source`: ë¶„ì„ ì†ŒìŠ¤ ë°ì´í„° (JSON)
- `analysis_result`: ë¶„ì„ ê²°ê³¼ (JSON)
- `created_at`: ìƒì„± ì‹œê°„

## ğŸš€ ì„¤ì¹˜ ë° ì‹¤í–‰

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­

- Node.js 20.x ì´ìƒ
- Python 3.10 ì´ìƒ
- npm ë˜ëŠ” yarn

### 1. ì €ì¥ì†Œ í´ë¡ 

```bash
git clone https://github.com/jy9307/essay-afs.git
cd essay-afs
```

### 2. í”„ë¡ íŠ¸ì—”ë“œ ì„¤ì •

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# ê°œë°œ ì„œë²„ ì‹¤í–‰ (http://localhost:3000)
npm run dev

# í”„ë¡œë•ì…˜ ë¹Œë“œ
npm run build

# í”„ë¡œë•ì…˜ ì„œë²„ ì‹¤í–‰
npm start
```

### 3. ë°±ì—”ë“œ ì„¤ì •

```bash
# backend ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd backend

# ê°€ìƒí™˜ê²½ ìƒì„± (ê¶Œì¥)
python -m venv env

# ê°€ìƒí™˜ê²½ í™œì„±í™”
# Windows
env\Scripts\activate
# macOS/Linux
source env/bin/activate

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# ê°œë°œ ì„œë²„ ì‹¤í–‰ (http://localhost:8000)
python main.py

# ë˜ëŠ” uvicorn ì§ì ‘ ì‹¤í–‰
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### 4. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

ë°ì´í„°ë² ì´ìŠ¤ëŠ” ë°±ì—”ë“œ ì„œë²„ ì‹œì‘ ì‹œ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.
ìˆ˜ë™ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ë ¤ë©´:

```bash
cd backend
python init_db.py
```

## ğŸ” í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

### ë°±ì—”ë“œ í™˜ê²½ ë³€ìˆ˜

`backend/.env` íŒŒì¼ ìƒì„±:

```env
# OpenAI API í‚¤ (í•„ìˆ˜)
OPENAI_API_KEY=your_openai_api_key_here

# JWT ì„¤ì •
SECRET_KEY=your_secret_key_here
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# ë°ì´í„°ë² ì´ìŠ¤ (ê¸°ë³¸ê°’ ì‚¬ìš© ê°€ëŠ¥)
DATABASE_URL=sqlite+aiosqlite:///./db/essay_afs.db

# CORS ì„¤ì • (í”„ë¡ íŠ¸ì—”ë“œ URL)
CORS_ORIGINS=http://localhost:3000,https://yourdomain.com
```

### í”„ë¡ íŠ¸ì—”ë“œ í™˜ê²½ ë³€ìˆ˜

`app/lib/api.ts`ì—ì„œ ë°±ì—”ë“œ URL ì„¤ì •:

```typescript
const api = axios.create({
  baseURL: 'http://localhost:8000', // ê°œë°œ í™˜ê²½
  // baseURL: "https://your-backend-api.com", // í”„ë¡œë•ì…˜ í™˜ê²½
  withCredentials: false,
});
```

## ğŸ“¡ API ì—”ë“œí¬ì¸íŠ¸

### ì¸ì¦ (auth.py)

| Method | Endpoint               | ì„¤ëª…                         |
| ------ | ---------------------- | ---------------------------- |
| POST   | `/auth/register`       | íšŒì›ê°€ì…                     |
| POST   | `/auth/login`          | ë¡œê·¸ì¸                       |
| GET    | `/auth/me`             | í˜„ì¬ ì‚¬ìš©ì ì •ë³´             |
| GET    | `/auth/me/full`        | ì‚¬ìš©ì ì „ì²´ ì •ë³´ (ê´€ê³„ í¬í•¨) |
| PATCH  | `/auth/feedback_guide` | í”¼ë“œë°± ê°€ì´ë“œ ì—…ë°ì´íŠ¸       |

### í•™ê¸‰ ê´€ë¦¬ (classes.py)

| Method | Endpoint              | ì„¤ëª…           |
| ------ | --------------------- | -------------- |
| GET    | `/classes`            | í•™ê¸‰ ëª©ë¡ ì¡°íšŒ |
| POST   | `/classes`            | í•™ê¸‰ ìƒì„±      |
| PUT    | `/classes/{class_id}` | í•™ê¸‰ ìˆ˜ì •      |
| DELETE | `/classes/{class_id}` | í•™ê¸‰ ì‚­ì œ      |

### í•™ìƒ ê´€ë¦¬ (students.py)

| Method | Endpoint                     | ì„¤ëª…             |
| ------ | ---------------------------- | ---------------- |
| GET    | `/students/class/{class_id}` | í•™ê¸‰ë³„ í•™ìƒ ëª©ë¡ |
| POST   | `/students`                  | í•™ìƒ ì¶”ê°€        |
| POST   | `/students/upload`           | CSV ì¼ê´„ ë“±ë¡    |
| POST   | `/students/delete`           | í•™ìƒ ì‚­ì œ        |

### ê³¼ì œ ê´€ë¦¬ (assignments.py)

| Method | Endpoint                              | ì„¤ëª…                         |
| ------ | ------------------------------------- | ---------------------------- |
| GET    | `/assignments/class/{class_id}`       | í•™ê¸‰ë³„ ê³¼ì œ ëª©ë¡             |
| GET    | `/assignments/{assignment_id}`        | ê³¼ì œ ìƒì„¸ ì¡°íšŒ               |
| POST   | `/assignments`                        | ê³¼ì œ ìƒì„±                    |
| PUT    | `/assignments/{assignment_id}`        | ê³¼ì œ ìˆ˜ì •                    |
| DELETE | `/assignments/{assignment_id}`        | ê³¼ì œ ì‚­ì œ                    |
| PATCH  | `/assignments/{assignment_id}/status` | ê³¼ì œ ìƒíƒœ ë³€ê²½               |
| POST   | `/assignments/start_assignment`       | ê³¼ì œ ì‹œì‘ (í•™ìƒë³„ ì œì¶œ ìƒì„±) |

### í‰ê°€ ê´€ë¦¬ (evaluation.py)

| Method | Endpoint                             | ì„¤ëª…                         |
| ------ | ------------------------------------ | ---------------------------- |
| GET    | `/evaluation/class/{class_id}`       | í•™ê¸‰ë³„ í‰ê°€ ëª©ë¡             |
| GET    | `/evaluation/{evaluation_id}`        | í‰ê°€ ìƒì„¸ ì¡°íšŒ               |
| POST   | `/evaluation`                        | í‰ê°€ ìƒì„±                    |
| PUT    | `/evaluation/{evaluation_id}`        | í‰ê°€ ìˆ˜ì •                    |
| DELETE | `/evaluation/{evaluation_id}`        | í‰ê°€ ì‚­ì œ                    |
| PATCH  | `/evaluation/{evaluation_id}/status` | í‰ê°€ ìƒíƒœ ë³€ê²½               |
| POST   | `/evaluation/start_evaluation`       | í‰ê°€ ì‹œì‘ (í•™ìƒë³„ ì œì¶œ ìƒì„±) |

### ì œì¶œë¬¼ ê´€ë¦¬ (submit.py)

| Method | Endpoint                               | ì„¤ëª…               |
| ------ | -------------------------------------- | ------------------ |
| GET    | `/submission/a`                        | ê³¼ì œ ì œì¶œ ì¡°íšŒ     |
| GET    | `/submission/e`                        | í‰ê°€ ì œì¶œ ì¡°íšŒ     |
| PATCH  | `/submission/update_assign_submission` | ê³¼ì œ ì œì¶œ ì—…ë°ì´íŠ¸ |
| PATCH  | `/submission/update_eval_submission`   | í‰ê°€ ì œì¶œ ì—…ë°ì´íŠ¸ |
| PATCH  | `/submission/patch_feedback`           | í”¼ë“œë°± ìˆ˜ì •        |

### AI í”¼ë“œë°± (ai.py)

| Method | Endpoint             | ì„¤ëª…             |
| ------ | -------------------- | ---------------- |
| POST   | `/ai/mid_feedback`   | ì¤‘ê°„ í”¼ë“œë°± ìƒì„± |
| POST   | `/ai/final_feedback` | ìµœì¢… í”¼ë“œë°± ìƒì„± |
| POST   | `/ai/score`          | AI ìë™ ì±„ì      |

### í•™ìƒ ë¶„ì„ (analysis.py)

| Method | Endpoint    | ì„¤ëª…                |
| ------ | ----------- | ------------------- |
| GET    | `/analysis` | í•™ìƒ ë¶„ì„ ê²°ê³¼ ì¡°íšŒ |
| POST   | `/analysis` | í•™ìƒ ë¶„ì„ ìƒì„±      |

## ğŸŒ ë°°í¬ ê°€ì´ë“œ

ì´ ê°€ì´ë“œëŠ” **Vercel (í”„ë¡ íŠ¸ì—”ë“œ)** + **Ubuntu ì„œë²„ (ë°±ì—”ë“œ + SQLite)** ë°°í¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

### ë°°í¬ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚         â”‚   Ubuntu ì„œë²„        â”‚
â”‚  Vercel         â”‚  HTTPS  â”‚                      â”‚
â”‚  (í”„ë¡ íŠ¸ì—”ë“œ)   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Nginx (ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ)â”‚
â”‚  Next.js        â”‚         â”‚         â†“            â”‚
â”‚                 â”‚         â”‚  Gunicorn + Uvicorn  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  (FastAPI ë°±ì—”ë“œ)    â”‚
                            â”‚         â†“            â”‚
                            â”‚  SQLite (DB)         â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1ï¸âƒ£ í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬ (Vercel)

### 1.1 Vercel ê³„ì • ë° í”„ë¡œì íŠ¸ ì„¤ì •

1. **Vercel ê³„ì • ìƒì„±**

   - https://vercel.com ì ‘ì†
   - GitHub ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸

2. **GitHub ì €ì¥ì†Œ ì—°ê²°**

   - Vercel ëŒ€ì‹œë³´ë“œì—ì„œ "New Project" í´ë¦­
   - GitHub ì €ì¥ì†Œ `essay-afs` ì„ íƒ
   - Import

3. **í”„ë¡œì íŠ¸ ì„¤ì •**
   - Framework Preset: **Next.js** (ìë™ ê°ì§€)
   - Root Directory: `./` (í”„ë¡œì íŠ¸ ë£¨íŠ¸)
   - Build Command: `npm run build` (ê¸°ë³¸ê°’)
   - Output Directory: `.next` (ê¸°ë³¸ê°’)

### 1.2 í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

Vercel í”„ë¡œì íŠ¸ ì„¤ì • â†’ Environment Variablesì—ì„œ ì¶”ê°€:

```env
NEXT_PUBLIC_API_URL=https://your-backend-domain.com
```

> âš ï¸ **ì¤‘ìš”**: `NEXT_PUBLIC_` ì ‘ë‘ì‚¬ë¥¼ ë°˜ë“œì‹œ ë¶™ì—¬ì•¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### 1.3 ì½”ë“œ ìˆ˜ì •

`app/lib/api.ts` íŒŒì¼ì„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •:

```typescript
const api = axios.create({
  baseURL: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000',
  withCredentials: false,
});
```

### 1.4 ë°°í¬

```bash
# ë¡œì»¬ì—ì„œ Vercel CLI ì‚¬ìš© (ì„ íƒì‚¬í•­)
npm install -g vercel
vercel login
vercel

# ë˜ëŠ” GitHubì— pushí•˜ë©´ ìë™ ë°°í¬
git add .
git commit -m "Update API URL for production"
git push origin main
```

### 1.5 ë„ë©”ì¸ ì„¤ì • (ì„ íƒì‚¬í•­)

- Vercel ëŒ€ì‹œë³´ë“œ â†’ Settings â†’ Domains
- ì»¤ìŠ¤í…€ ë„ë©”ì¸ ì¶”ê°€ (ì˜ˆ: `essay-afs.com`)
- DNS ì„¤ì •ì—ì„œ CNAME ë ˆì½”ë“œ ì¶”ê°€

---

## 2ï¸âƒ£ ë°±ì—”ë“œ ë°°í¬ (Ubuntu ì„œë²„)

### 2.1 ì„œë²„ ì´ˆê¸° ì„¤ì •

#### SSH ì ‘ì†

```bash
ssh username@your-server-ip
```

#### ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸

```bash
sudo apt update
sudo apt upgrade -y
```

#### í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
sudo apt install -y python3 python3-pip python3-venv git nginx certbot python3-certbot-nginx
```

### 2.2 í”„ë¡œì íŠ¸ í´ë¡  ë° ì„¤ì •

```bash
# í™ˆ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd ~

# í”„ë¡œì íŠ¸ í´ë¡ 
git clone https://github.com/jy9307/essay-afs.git
cd essay-afs/backend

# Python ê°€ìƒí™˜ê²½ ìƒì„±
python3 -m venv env
source env/bin/activate

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt
pip install gunicorn  # í”„ë¡œë•ì…˜ ì„œë²„ìš©
```

### 2.3 í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
nano .env
```

ë‹¤ìŒ ë‚´ìš© ì…ë ¥:

```env
# OpenAI API í‚¤
OPENAI_API_KEY=your_openai_api_key_here

# JWT ì„¤ì •
SECRET_KEY=your_very_secure_secret_key_here
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# SQLite ë°ì´í„°ë² ì´ìŠ¤ (ê¸°ë³¸ê°’)
DATABASE_URL=sqlite+aiosqlite:///./db/essay_afs.db

# CORS ì„¤ì • (Vercel ë„ë©”ì¸ ì¶”ê°€)
CORS_ORIGINS=https://your-vercel-app.vercel.app,https://your-custom-domain.com
```

> ğŸ’¡ **SECRET_KEY ìƒì„± ë°©ë²•**:
>
> ```bash
> python3 -c "import secrets; print(secrets.token_urlsafe(32))"
> ```

### 2.4 ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

```bash
cd ~/essay-afs/backend
source env/bin/activate
python init_db.py
```

### 2.5 SQLite ë°±ì—… ì„¤ì •

#### ìˆ˜ë™ ë°±ì—…

```bash
# ë°±ì—…
cp ~/essay-afs/db/essay_afs.db ~/essay-afs/db/essay_afs_backup_$(date +%Y%m%d).db
```

#### ìë™ ë°±ì—… (Cron)

```bash
# ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
nano ~/backup_db.sh
```

```bash
#!/bin/bash
BACKUP_DIR="/home/ubuntu/db_backups"
DB_PATH="/home/ubuntu/essay-afs/db/essay_afs.db"
mkdir -p $BACKUP_DIR
cp $DB_PATH $BACKUP_DIR/essay_afs_backup_$(date +%Y%m%d_%H%M%S).db

# 7ì¼ ì´ìƒ ëœ ë°±ì—… ì‚­ì œ
find $BACKUP_DIR -name "essay_afs_backup_*.db" -mtime +7 -delete
```

```bash
# ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x ~/backup_db.sh

# Cron ì‘ì—… ì¶”ê°€ (ë§¤ì¼ ìƒˆë²½ 2ì‹œ)
crontab -e
```

ë‹¤ìŒ ë¼ì¸ ì¶”ê°€:

```
0 2 * * * /home/ubuntu/backup_db.sh
```

---

## 3ï¸âƒ£ Gunicorn + Systemd ì„¤ì •

### 3.1 Systemd ì„œë¹„ìŠ¤ íŒŒì¼ ìƒì„±

```bash
sudo nano /etc/systemd/system/essay-afs.service
```

ë‹¤ìŒ ë‚´ìš© ì…ë ¥:

```ini
[Unit]
Description=Essay-AFS FastAPI Application
After=network.target

[Service]
Type=notify
User=ubuntu
Group=ubuntu
WorkingDirectory=/home/ubuntu/essay-afs/backend
Environment="PATH=/home/ubuntu/essay-afs/backend/env/bin"
ExecStart=/home/ubuntu/essay-afs/backend/env/bin/gunicorn main:app \
    --workers 4 \
    --worker-class uvicorn.workers.UvicornWorker \
    --bind 127.0.0.1:8000 \
    --timeout 120 \
    --access-logfile /var/log/essay-afs/access.log \
    --error-logfile /var/log/essay-afs/error.log
ExecReload=/bin/kill -s HUP $MAINPID
KillMode=mixed
KillSignal=SIGQUIT
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```

### 3.2 ë¡œê·¸ ë””ë ‰í† ë¦¬ ìƒì„±

```bash
sudo mkdir -p /var/log/essay-afs
sudo chown ubuntu:ubuntu /var/log/essay-afs
```

### 3.3 ì„œë¹„ìŠ¤ ì‹œì‘

```bash
# ì„œë¹„ìŠ¤ ë“±ë¡
sudo systemctl daemon-reload
sudo systemctl enable essay-afs

# ì„œë¹„ìŠ¤ ì‹œì‘
sudo systemctl start essay-afs

# ìƒíƒœ í™•ì¸
sudo systemctl status essay-afs

# ë¡œê·¸ í™•ì¸
sudo journalctl -u essay-afs -f
```

### 3.4 ì„œë¹„ìŠ¤ ê´€ë¦¬ ëª…ë ¹ì–´

```bash
# ì¬ì‹œì‘
sudo systemctl restart essay-afs

# ì¤‘ì§€
sudo systemctl stop essay-afs

# ë¡œê·¸ í™•ì¸
sudo tail -f /var/log/essay-afs/error.log
sudo tail -f /var/log/essay-afs/access.log
```

---

## 4ï¸âƒ£ Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„¤ì •

### 4.1 Nginx ì„¤ì • íŒŒì¼ ìƒì„±

```bash
sudo nano /etc/nginx/sites-available/essay-afs
```

ë‹¤ìŒ ë‚´ìš© ì…ë ¥:

```nginx
server {
    listen 80;
    server_name your-backend-domain.com;  # ì‹¤ì œ ë„ë©”ì¸ìœ¼ë¡œ ë³€ê²½

    client_max_body_size 10M;

    # ë¡œê·¸ ì„¤ì •
    access_log /var/log/nginx/essay-afs-access.log;
    error_log /var/log/nginx/essay-afs-error.log;

    # FastAPI ë°±ì—”ë“œë¡œ í”„ë¡ì‹œ
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket ì§€ì› (í•„ìš”í•œ ê²½ìš°)
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        # íƒ€ì„ì•„ì›ƒ ì„¤ì •
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
}
```

### 4.2 Nginx ì„¤ì • í™œì„±í™”

```bash
# ì‹¬ë³¼ë¦­ ë§í¬ ìƒì„±
sudo ln -s /etc/nginx/sites-available/essay-afs /etc/nginx/sites-enabled/

# ê¸°ë³¸ ì‚¬ì´íŠ¸ ë¹„í™œì„±í™” (ì„ íƒì‚¬í•­)
sudo rm /etc/nginx/sites-enabled/default

# ì„¤ì • í…ŒìŠ¤íŠ¸
sudo nginx -t

# Nginx ì¬ì‹œì‘
sudo systemctl restart nginx
sudo systemctl status nginx
```

---

## 5ï¸âƒ£ SSL ì¸ì¦ì„œ ì„¤ì • (Let's Encrypt)

### 5.1 Certbotìœ¼ë¡œ SSL ì¸ì¦ì„œ ë°œê¸‰

```bash
# SSL ì¸ì¦ì„œ ìë™ ë°œê¸‰ ë° Nginx ì„¤ì •
sudo certbot --nginx -d your-backend-domain.com

# ì´ë©”ì¼ ì…ë ¥ ë° ì•½ê´€ ë™ì˜
# Redirect HTTP to HTTPS? â†’ Yes ì„ íƒ
```

### 5.2 ìë™ ê°±ì‹  ì„¤ì •

```bash
# ìë™ ê°±ì‹  í…ŒìŠ¤íŠ¸
sudo certbot renew --dry-run

# Cronì€ ìë™ìœ¼ë¡œ ì„¤ì •ë¨ (í™•ì¸)
sudo systemctl status certbot.timer
```

### 5.3 SSL ì„¤ì • í›„ Nginx ì¬ì‹œì‘

```bash
sudo systemctl restart nginx
```

ì´ì œ `https://your-backend-domain.com`ìœ¼ë¡œ ì ‘ì† ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## 6ï¸âƒ£ ë°©í™”ë²½ ì„¤ì •

### 6.1 UFW ë°©í™”ë²½ ì„¤ì •

```bash
# UFW í™œì„±í™”
sudo ufw enable

# SSH í—ˆìš© (ì¤‘ìš”!)
sudo ufw allow 22/tcp
sudo ufw allow OpenSSH

# HTTP, HTTPS í—ˆìš©
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# ìƒíƒœ í™•ì¸
sudo ufw status verbose
```

### 6.2 í´ë¼ìš°ë“œ ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •

AWS EC2, DigitalOcean ë“±ì˜ ê²½ìš° ì¶”ê°€ë¡œ ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •:

- **Inbound Rules**:
  - SSH (22): Your IP
  - HTTP (80): 0.0.0.0/0
  - HTTPS (443): 0.0.0.0/0

---

## 7ï¸âƒ£ ë°°í¬ í™•ì¸ ë° í…ŒìŠ¤íŠ¸

### 7.1 ë°±ì—”ë“œ API í…ŒìŠ¤íŠ¸

```bash
# í—¬ìŠ¤ ì²´í¬
curl https://your-backend-domain.com/health

# API ë¬¸ì„œ í™•ì¸
# ë¸Œë¼ìš°ì €ì—ì„œ https://your-backend-domain.com/docs ì ‘ì†
```

### 7.2 í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸

1. Vercel ë°°í¬ URL ì ‘ì† (ì˜ˆ: `https://essay-afs.vercel.app`)
2. íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
3. í•™ê¸‰ ìƒì„±, í•™ìƒ ì¶”ê°€ ë“± ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

### 7.3 ë¡œê·¸ ëª¨ë‹ˆí„°ë§

```bash
# ë°±ì—”ë“œ ë¡œê·¸
sudo journalctl -u essay-afs -f

# Nginx ë¡œê·¸
sudo tail -f /var/log/nginx/essay-afs-access.log
sudo tail -f /var/log/nginx/essay-afs-error.log
```

---

## 8ï¸âƒ£ ë°°í¬ í›„ ìœ ì§€ë³´ìˆ˜

### 8.1 ì½”ë“œ ì—…ë°ì´íŠ¸

```bash
cd ~/essay-afs
git pull origin main

# ë°±ì—”ë“œ ì—…ë°ì´íŠ¸
cd backend
source env/bin/activate
pip install -r requirements.txt

# ì„œë¹„ìŠ¤ ì¬ì‹œì‘
sudo systemctl restart essay-afs
```

### 8.2 ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

ëª¨ë¸ ë³€ê²½ ì‹œ:

```bash
cd ~/essay-afs/backend
source env/bin/activate
python init_db.py  # ë˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
sudo systemctl restart essay-afs
```

### 8.3 ëª¨ë‹ˆí„°ë§

#### ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ í™•ì¸

```bash
# CPU, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
htop

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
df -h

# í”„ë¡œì„¸ìŠ¤ í™•ì¸
ps aux | grep gunicorn
```

#### ë¡œê·¸ ë¡œí…Œì´ì…˜ ì„¤ì •

```bash
sudo nano /etc/logrotate.d/essay-afs
```

```
/var/log/essay-afs/*.log {
    daily
    rotate 14
    compress
    delaycompress
    notifempty
    create 0640 ubuntu ubuntu
    sharedscripts
    postrotate
        systemctl reload essay-afs > /dev/null 2>&1 || true
    endscript
}
```

### 8.4 ì„±ëŠ¥ ìµœì í™”

#### Gunicorn ì›Œì»¤ ìˆ˜ ì¡°ì •

```bash
# CPU ì½”ì–´ ìˆ˜ í™•ì¸
nproc

# ê¶Œì¥ ì›Œì»¤ ìˆ˜: (2 x CPU ì½”ì–´ ìˆ˜) + 1
# ì˜ˆ: 2ì½”ì–´ â†’ 5 workers
sudo nano /etc/systemd/system/essay-afs.service
```

`--workers 4`ë¥¼ ì ì ˆí•œ ê°’ìœ¼ë¡œ ë³€ê²½ í›„:

```bash
sudo systemctl daemon-reload
sudo systemctl restart essay-afs
```

---

## 9ï¸âƒ£ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: 502 Bad Gateway

**ì›ì¸**: Gunicorn ì„œë¹„ìŠ¤ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

**í•´ê²°**:

```bash
sudo systemctl status essay-afs
sudo journalctl -u essay-afs -n 50
sudo systemctl restart essay-afs
```

### ë¬¸ì œ 2: CORS ì—ëŸ¬

**ì›ì¸**: CORS ì„¤ì •ì— Vercel ë„ë©”ì¸ì´ ì—†ìŒ

**í•´ê²°**:

```bash
nano ~/essay-afs/backend/.env
```

`CORS_ORIGINS`ì— Vercel URL ì¶”ê°€ í›„:

```bash
sudo systemctl restart essay-afs
```

### ë¬¸ì œ 3: ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ ê¶Œí•œ ë¬¸ì œ

**ì›ì¸**: SQLite íŒŒì¼ ë˜ëŠ” ë””ë ‰í† ë¦¬ ê¶Œí•œ ë¬¸ì œ

**í•´ê²°**:

```bash
# db ë””ë ‰í† ë¦¬ ë° íŒŒì¼ ê¶Œí•œ í™•ì¸
ls -la ~/essay-afs/db/

# ê¶Œí•œ ìˆ˜ì •
chmod 755 ~/essay-afs/db
chmod 644 ~/essay-afs/db/essay_afs.db
chown ubuntu:ubuntu ~/essay-afs/db/essay_afs.db
```

### ë¬¸ì œ 4: SSL ì¸ì¦ì„œ ê°±ì‹  ì‹¤íŒ¨

**ì›ì¸**: Certbot ìë™ ê°±ì‹  ì‹¤íŒ¨

**í•´ê²°**:

```bash
sudo certbot renew --force-renewal
sudo systemctl restart nginx
```

---

## ğŸ“Š ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í”„ë¡ íŠ¸ì—”ë“œ (Vercel)

- [ ] GitHub ì €ì¥ì†Œ ì—°ê²°
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (`NEXT_PUBLIC_API_URL`)
- [ ] ë°°í¬ ì„±ê³µ í™•ì¸
- [ ] ì»¤ìŠ¤í…€ ë„ë©”ì¸ ì„¤ì • (ì„ íƒì‚¬í•­)

### ë°±ì—”ë“œ (Ubuntu ì„œë²„)

- [ ] ì„œë²„ ì´ˆê¸° ì„¤ì • ì™„ë£Œ
- [ ] í”„ë¡œì íŠ¸ í´ë¡  ë° ì˜ì¡´ì„± ì„¤ì¹˜
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (`.env`)
- [ ] SQLite ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
- [ ] Systemd ì„œë¹„ìŠ¤ ë“±ë¡ ë° ì‹œì‘
- [ ] Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„¤ì •
- [ ] SSL ì¸ì¦ì„œ ë°œê¸‰
- [ ] ë°©í™”ë²½ ì„¤ì •
- [ ] API í…ŒìŠ¤íŠ¸ ì„±ê³µ

### ë³´ì•ˆ

- [ ] `.env` íŒŒì¼ ê¶Œí•œ ì„¤ì • (`chmod 600 .env`)
- [ ] SECRET_KEY ê°•ë ¥í•˜ê²Œ ì„¤ì •
- [ ] SSH í‚¤ ê¸°ë°˜ ì¸ì¦ ì„¤ì •
- [ ] ë¶ˆí•„ìš”í•œ í¬íŠ¸ ì°¨ë‹¨
- [ ] ì •ê¸° ë°±ì—… ì„¤ì •

### ëª¨ë‹ˆí„°ë§

- [ ] ë¡œê·¸ í™•ì¸ ê°€ëŠ¥
- [ ] ìë™ ì¬ì‹œì‘ ì„¤ì •
- [ ] ë°±ì—… ìë™í™”
- [ ] ë¡œê·¸ ë¡œí…Œì´ì…˜ ì„¤ì •

---

## ğŸ“š ì¶”ê°€ ë¦¬ì†ŒìŠ¤

- [Vercel ë¬¸ì„œ](https://vercel.com/docs)
- [FastAPI ë°°í¬ ê°€ì´ë“œ](https://fastapi.tiangolo.com/deployment/)
- [Nginx ê³µì‹ ë¬¸ì„œ](https://nginx.org/en/docs/)
- [Let's Encrypt ë¬¸ì„œ](https://letsencrypt.org/docs/)

---

1. **ì„œë²„ ì ‘ì† ë° í”„ë¡œì íŠ¸ í´ë¡ **

   ```bash
   git clone https://github.com/jy9307/essay-afs.git
   cd essay-afs/backend
   ```

2. **Python í™˜ê²½ ì„¤ì •**

   ```bash
   python3 -m venv env
   source env/bin/activate
   pip install -r requirements.txt
   ```

3. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**

   ```bash
   nano .env
   # OPENAI_API_KEY, SECRET_KEY ë“± ì„¤ì •
   ```

4. **Gunicorn + Uvicornìœ¼ë¡œ ì‹¤í–‰**

   ```bash
   pip install gunicorn
   gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000
   ```

5. **Systemd ì„œë¹„ìŠ¤ ë“±ë¡ (ìë™ ì‹œì‘)**

   ```bash
   sudo nano /etc/systemd/system/essay-afs.service
   ```

   ```ini
   [Unit]
   Description=Essay-AFS FastAPI
   After=network.target

   [Service]
   User=ubuntu
   WorkingDirectory=/home/ubuntu/essay-afs/backend
   Environment="PATH=/home/ubuntu/essay-afs/backend/env/bin"
   ExecStart=/home/ubuntu/essay-afs/backend/env/bin/gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000

   [Install]
   WantedBy=multi-user.target
   ```

   ```bash
   sudo systemctl enable essay-afs
   sudo systemctl start essay-afs
   sudo systemctl status essay-afs
   ```

6. **Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„¤ì •**

   ```bash
   sudo nano /etc/nginx/sites-available/essay-afs
   ```

   ```nginx
   server {
       listen 80;
       server_name your-domain.com;

       location / {
           proxy_pass http://127.0.0.1:8000;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
       }
   }
   ```

   ```bash
   sudo ln -s /etc/nginx/sites-available/essay-afs /etc/nginx/sites-enabled/
   sudo nginx -t
   sudo systemctl restart nginx
   ```

7. **SSL ì¸ì¦ì„œ ì„¤ì • (Let's Encrypt)**
   ```bash
   sudo apt install certbot python3-certbot-nginx
   sudo certbot --nginx -d your-domain.com
   ```

#### ë°©ë²• 2: Docker ë°°í¬

1. **Dockerfile ìƒì„±** (`backend/Dockerfile`)

   ```dockerfile
   FROM python:3.10-slim

   WORKDIR /app

   COPY requirements.txt .
   RUN pip install --no-cache-dir -r requirements.txt

   COPY . .

   EXPOSE 8000

   CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
   ```

2. **Docker ì´ë¯¸ì§€ ë¹Œë“œ ë° ì‹¤í–‰**
   ```bash
   docker build -t essay-afs-backend .
   docker run -d -p 8000:8000 --env-file .env essay-afs-backend
   ```

#### ë°©ë²• 3: Railway, Render ë“± PaaS

1. **Railway ë°°í¬**

   - Railway ê³„ì • ìƒì„±
   - GitHub ì €ì¥ì†Œ ì—°ê²°
   - `backend` ë””ë ‰í† ë¦¬ ì„ íƒ
   - í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (OPENAI_API_KEY ë“±)
   - ìë™ ë°°í¬

2. **Render ë°°í¬**
   - Render ê³„ì • ìƒì„±
   - New Web Service ì„ íƒ
   - GitHub ì €ì¥ì†Œ ì—°ê²°
   - Build Command: `pip install -r requirements.txt`
   - Start Command: `uvicorn main:app --host 0.0.0.0 --port $PORT`
   - í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

### ë°ì´í„°ë² ì´ìŠ¤ ë°°í¬

#### ê°œë°œ/ì†Œê·œëª¨: SQLite (í˜„ì¬ ì„¤ì •)

- íŒŒì¼ ê¸°ë°˜ DBë¡œ ê°„ë‹¨í•œ ë°°í¬
- `db/essay_afs.db` íŒŒì¼ ë°±ì—… í•„ìš”

#### í”„ë¡œë•ì…˜/ëŒ€ê·œëª¨: PostgreSQL ê¶Œì¥

1. **PostgreSQL ì„¤ì¹˜ ë˜ëŠ” í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ì‚¬ìš©**

   - AWS RDS, Google Cloud SQL, Supabase ë“±

2. **ì˜ì¡´ì„± ì¶”ê°€**

   ```bash
   pip install asyncpg psycopg2-binary
   ```

3. **database.py ìˆ˜ì •**

   ```python
   SQLALCHEMY_DATABASE_URL = "postgresql+asyncpg://user:password@host:5432/dbname"
   ```

4. **í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬**
   ```env
   DATABASE_URL=postgresql+asyncpg://user:password@host:5432/dbname
   ```

### CORS ì„¤ì • (ì¤‘ìš”!)

í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œê°€ ë‹¤ë¥¸ ë„ë©”ì¸ì— ë°°í¬ëœ ê²½ìš°, `backend/main.py`ì—ì„œ CORS ì„¤ì •:

```python
app.add_middleware(
    CORSMiddleware,
    allow_origins=[
        "http://localhost:3000",  # ê°œë°œ
        "https://your-frontend-domain.vercel.app",  # í”„ë¡œë•ì…˜
    ],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

## ğŸ”§ ê°œë°œ ë° ìš´ì˜ íŒ

### í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ

- **Hot Reload**: `npm run dev`ë¡œ ì‹¤í–‰ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨
- **íƒ€ì… ì²´í¬**: TypeScriptë¡œ íƒ€ì… ì•ˆì •ì„± í™•ë³´
- **API í•¨ìˆ˜**: `app/lib/api.ts`ì— ëª¨ë“  API í˜¸ì¶œ í•¨ìˆ˜ ì •ì˜
- **ì¸ì¦**: `app/hooks/auth.ts`ì—ì„œ í† í° ê´€ë¦¬

### ë°±ì—”ë“œ ê°œë°œ

- **ìë™ ë¦¬ë¡œë“œ**: `uvicorn main:app --reload`
- **API ë¬¸ì„œ**: http://localhost:8000/docs (Swagger UI)
- **ëŒ€í™”í˜• API**: http://localhost:8000/redoc
- **DB ë§ˆì´ê·¸ë ˆì´ì…˜**: ëª¨ë¸ ë³€ê²½ ì‹œ `init_db.py` ì‹¤í–‰

### ë””ë²„ê¹…

- **í”„ë¡ íŠ¸ì—”ë“œ**: ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ Console
- **ë°±ì—”ë“œ**: FastAPI ë¡œê·¸ í™•ì¸ (`echo=True` ì„¤ì • ì‹œ SQL ì¿¼ë¦¬ ì¶œë ¥)
- **ë„¤íŠ¸ì›Œí¬**: Axios ìš”ì²­/ì‘ë‹µ í™•ì¸

## ğŸ“ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ë¥¼ ë”°ë¦…ë‹ˆë‹¤.

## ğŸ‘¥ ê¸°ì—¬

ë²„ê·¸ ë¦¬í¬íŠ¸, ê¸°ëŠ¥ ì œì•ˆ, Pull Requestë¥¼ í™˜ì˜í•©ë‹ˆë‹¤!

## ğŸ“§ ë¬¸ì˜

í”„ë¡œì íŠ¸ ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì€ GitHub Issuesë¥¼ ì´ìš©í•´ì£¼ì„¸ìš”.

---

**Essay-AFS** - AI ê¸°ë°˜ ì—ì„¸ì´ í”¼ë“œë°± ì‹œìŠ¤í…œ
